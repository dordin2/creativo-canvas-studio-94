@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;

    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;

    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;

    --primary: 262 83% 63%;
    --primary-foreground: 210 40% 98%;

    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;

    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;

    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;

    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;

    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 262 83% 63%;

    --radius: 0.5rem;

    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 262 83% 63%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 240 4.8% 95.9%;
    --sidebar-accent-foreground: 240 5.9% 10%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 262 83% 63%;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;

    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;

    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;

    --primary: 262 83% 63%;
    --primary-foreground: 222.2 47.4% 11.2%;

    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;

    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;

    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;

    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 262 83% 63%;

    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 262 83% 63%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 262 83% 63%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-family: 'Inter', sans-serif;
  }

  .canvas-element {
    @apply cursor-move transition-transform duration-75 ease-out relative;
    will-change: transform, left, top, width, height, z-index;
    touch-action: none;
    /* Allow elements to extend beyond their parent container */
    pointer-events: auto !important;
  }

  .canvas-element:hover {
    @apply outline outline-2 outline-canvas-purple/30;
  }
  
  /* Canvas container to manage overflow behavior */
  .canvas-container {
    position: relative;
    /* Allow controls to remain visible outside the canvas */
    overflow: visible !important;
    pointer-events: auto;
  }
  
  /* Main canvas has overflow:hidden to mask content */
  .canvas-container > div:first-child {
    overflow: hidden !important;
    /* Controls should still be interactive even outside the canvas */
    pointer-events: auto;
  }

  /* Ensure resize and rotation handles are always visible */
  .resize-handle {
    @apply absolute w-3 h-3 bg-canvas-purple border-2 border-white rounded-full shadow-md z-[1000];
    pointer-events: auto !important;
    /* Ensure handles are visible outside the canvas */
    position: absolute;
    visibility: visible !important;
    display: block !important;
  }

  .rotation-handle {
    @apply absolute w-5 h-5 rounded-full bg-canvas-purple border-2 border-white flex items-center justify-center cursor-move shadow-md z-[1000];
    pointer-events: auto !important;
    /* Ensure rotation handle is visible outside the canvas */
    position: absolute;
    visibility: visible !important;
    display: block !important;
  }
  
  /* Element controls wrapper that sits outside the canvas overflow */
  .element-controls-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1000;
    overflow: visible !important;
  }

  /* Frame for the selection border that extends beyond canvas */
  .element-frame {
    position: absolute;
    border: 2px solid #8B5CF6;
    pointer-events: none;
    z-index: 999;
    box-sizing: border-box;
  }
}

/* Canvas workspace styling */
.canvas-workspace {
  background-size: 20px 20px;
  background-image: 
    linear-gradient(to right, rgba(0, 0, 0, 0.05) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
}

/* Cursor styles for resize handlers */
.cursor-nw-resize { cursor: nw-resize; }
.cursor-n-resize { cursor: n-resize; }
.cursor-ne-resize { cursor: ne-resize; }
.cursor-e-resize { cursor: e-resize; }
.cursor-se-resize { cursor: se-resize; }
.cursor-s-resize { cursor: s-resize; }
.cursor-sw-resize { cursor: sw-resize; }
.cursor-w-resize { cursor: w-resize; }

/* Fix for side panels */
.sidebar-panel {
  @apply h-full bg-white overflow-y-auto;
  min-width: 16rem;
  width: 16rem;
  flex: 0 0 auto;
}

.properties-panel {
  @apply h-full bg-sidebar-background text-sidebar-foreground overflow-y-auto;
  min-width: 20rem;
  width: 20rem;
  flex: 0 0 auto;
}

/* Zoom controls */
.zoom-controls {
  @apply fixed bottom-4 right-4 flex items-center gap-2 bg-white p-2 rounded-lg shadow-md z-50;
}

.zoom-controls button {
  @apply bg-sidebar-accent hover:bg-sidebar-accent-foreground/10 text-sidebar-foreground rounded-md p-2 transition-colors;
}

.zoom-controls span {
  @apply px-2 text-sm font-medium text-sidebar-foreground;
}

/* Sequence Puzzle Drag and Drop styles */
.dragging {
  opacity: 0.6;
  transform: scale(1.05);
  z-index: 100;
}

.drag-over {
  border-color: #8B5CF6;
  box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.3);
  transform: scale(1.03);
}

/* Custom drag ghost image */
[draggable] {
  user-select: none;
  -webkit-user-drag: element;
}

/* Hide default drag image in Firefox */
@-moz-document url-prefix() {
  [draggable] {
    -moz-user-select: none;
  }
}
